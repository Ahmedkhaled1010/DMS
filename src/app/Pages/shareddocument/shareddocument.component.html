<div class="shared-documents-container" dir="rtl">
  <p-toast></p-toast>

  <div class="page-header">
    <div>
      <h1 class="page-title">المشتركة معي</h1>
      <p class="page-subtitle">المستندات التي تمت مشاركتها معك</p>
    </div>
  </div>

  <p-card styleClass="main-content-card">
    <ng-template pTemplate="content">
      <div *ngIf="loading" class="loading-state">
        <p-progressSpinner styleClass="w-6rem h-6rem" strokeWidth="5" fill="var(--surface-ground)" animationDuration=".8s"></p-progressSpinner>
        <p class="text-xl text-gray-600 mt-5">جاري تحميل المستندات المشتركة...</p>
      </div>

      <div *ngIf="!loading && error" class="error-state">
        <i class="pi pi-exclamation-triangle text-red-500 text-6xl mb-4"></i>
        <h3 class="text-2xl font-bold text-gray-800 mb-2">حدث خطأ</h3>
        <p class="text-red-600 text-lg font-medium">{{ error }}</p>
        <p-button label="إعادة المحاولة" icon="pi pi-refresh" (onClick)="fetchSharedDocuments()" styleClass="mt-5 p-button-secondary p-button-outlined"></p-button>
      </div>

      <div *ngIf="!loading && !error && sharedDocuments.length === 0" class="empty-state">
        <i class="pi pi-share-alt text-gray-300 text-8xl mb-6"></i>
        <h3 class="text-3xl font-bold text-gray-800 mb-3">لا توجد مستندات مشتركة</h3>
        <p class="text-gray-600 text-xl">لم تتم مشاركة أي مستندات معك حاليًا.</p>
      </div>

      <div *ngIf="!loading && !error && sharedDocuments.length > 0" class="documents-grid">
        <p-card *ngFor="let doc of sharedDocuments" styleClass="document-item-card">
          <ng-template pTemplate="content">
            <div class="document-item-content">
              <div class="document-icon-wrapper">
                <i class="pi pi-file text-blue-500"></i>
              </div>
              <div class="document-details">
                <h3 class="document-title">{{ doc.fileName }}</h3>
                <p class="document-filename">{{ doc.fileType }}</p>
                <div class="document-meta-badges">
                  <span class="tag-badge">{{ doc.tag }}</span>
                  <span class="privacy-badge">{{ doc.privacy }}</span>
                </div>
                <div *ngIf="doc.username" class="shared-by-info">
                  <i class="pi pi-user text-gray-500 text-sm"></i>
                  <span class="text-gray-700 text-sm font-medium">تمت المشاركة بواسطة: {{ doc.username }}</span>
                </div>
              </div>
              <!-- No actions for shared documents in this view, but can be added -->
            </div>
          </ng-template>
        </p-card>
      </div>
    </ng-template>
  </p-card>
</div>
